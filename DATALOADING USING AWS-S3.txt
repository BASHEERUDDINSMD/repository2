DATA LOADING USING AWS S3:
CREATED S3 BUCKET THEN CREATED FOLDERS THEN UPLOADED FILES 
CREATED 1 USER IN AWS USING IAM THEN GRANT 1 PERMISSION
CREATED STAGE IN SNOWFLAKE
PROVIDED ACCESS TO STAGE

STAGED TABLE WILL HAVE ONLY META DATA 

 COPY INTO "HYD"."DATALOADS"."MY_CALL_CENTER" 
 FROM '@"HYD"."SAMPLE_SCHEMA"."SAMPLE_S3_STORAGE"/s3://my-s3-bucket-sample2/test-sample/CALL_CENTER TABLE.csv' 
 FILE_FORMAT = '"HYD"."SAMPLE_SCHEMA"."CSV_FILE"' ON_ERROR = 'ABORT_STATEMENT' PURGE = FALSE;

USE ROLE SYSADMIN;
USE WAREHOUSE SHAIK_WH;
USE DATABASE HYD;
USE SCHEMA DATA_LOADS;

CREATE STAGE SAMPLE_STAGE
URL='s3://call-center-bucket/';

LIST @SAMPLE_STAGE;

CREATE OR REPLACE STAGE SAMPLE_STAGE
URL='s3://call-center-bucket/saba/'
CREDENTIALS=(AWS_KEY_ID='AKIAZQTBQ47JHYVCHHGG'
            AWS_SECRET_KEY='9vkCQNLXXR9+DaPCZl494+3PquJaplq2soeSBast'
            );

LIST @SAMPLE_STAGE;

SHOW STAGES;

TRUNCATE TABLE "HYD"."DATA_LOADS"."CUSTOMER_TEST";

COPY INTO "HYD"."DATA_LOADS"."CUSTOMER" FROM '@"HYD"."DATA_LOADS"."SAMPLE_STAGE"/CUSTOMER.csv' 
FILE_FORMAT = '"HYD"."DATA_LOADS"."CSV_FILE_FORMAT"' 
ON_ERROR = 'ABORT_STATEMENT' PURGE = FALSE;

COPY INTO "HYD"."DATA_LOADS"."CUSTOMER" FROM '@"HYD"."DATA_LOADS"."SAMPLE_STAGE"/call-center.csv' 
FILE_FORMAT = '"HYD"."DATA_LOADS"."CS_FORMAT1"' 
ON_ERROR = 'CONTINUE' PURGE = FALSE;

COPY INTO "HYD"."DATA_LOADS"."CUSTOMER_TEST" FROM '@"HYD"."DATA_LOADS"."SAMPLE_STAGE"/CUSTOMER.csv' 
FILE_FORMAT = '"HYD"."DATA_LOADS"."CSV_FILE_FORMAT"' 
ON_ERROR = 'CONTINUE' PURGE = FALSE;

SELECT * FROM "HYD"."INFORMATION_SCHEMA"."LOAD_HISTORY" WHERE TABLE_NAME LIKE 'CUSTOMER';
CREATE OR REPLACE TABLE ERROR_TABLE AS select * from table(validate(CUSTOMER_TEST, job_id => '_last'));
